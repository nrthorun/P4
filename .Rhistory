filter(complete.cases(`Nota do Consumidor`)) %>%
group_by(`Nome`) %>%
summarize(n = length(`Nota do Consumidor`), media = mean(`Nota do Consumidor`)) %>%
arrange(-n)
p2 <- ggplot(var, aes(x=reorder(Nome,-n), y=media)) +
geom_histogram(stat = 'identity', fill="dodgerblue4") +
geom_text(aes(label=format(round(media, 2), nsmall = 2), vjust=1), color="White") +
scale_x_discrete(labels = var$Nome) +
labs(title = "Índice de Satisfação") +
theme(title=element_text(size = rel(0.6)),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))
var <- telecom %>%
select(`Tempo Resposta`,`Nome`, `Nota do Consumidor`) %>%
filter(complete.cases(`Tempo Resposta`)) %>%
group_by(`Nome`) %>%
summarize(n = length(`Tempo Resposta`), media = mean(`Tempo Resposta`)) %>%
arrange(-n)
p3 <- ggplot(var, aes(x=reorder(Nome,-n), y=media)) +
geom_histogram(stat = 'identity', fill="dodgerblue4") +
geom_text(aes(label=format(round(media, 2), nsmall = 2), vjust=1), color="White") +
scale_x_discrete(labels = var$Nome) +
labs(title = "Tempo Médio de Resposta (em dias)") +
theme(title=element_text(size = rel(0.6)),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))
var <- telecom %>%
select(`Respondida`,`Nome`, `Nota do Consumidor`) %>%
group_by(`Nome`) %>%
summarize(n = length(Respondida), m = sum(Respondida == 'S')) %>%
mutate(resposta = m/n) %>%
arrange(-n)
p4 <- ggplot(var, aes(x=reorder(Nome,-n), y=resposta)) +
geom_histogram(stat = 'identity', fill="dodgerblue4") +
geom_text(aes(label=paste0(sprintf("%.0f", resposta*100),"%"), vjust=1), color="White") +
scale_x_discrete(labels = var$Nome) +
labs(title = "Reclamações Respondidas") +
scale_y_continuous(labels = scales::percent) +
theme(title=element_text(size = rel(0.6)),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))
ggarrange(p1, p2, p3, p4,
ncol = 2, nrow = 2)
var <- telecom %>%
select(`Nome`,`Grupo Problema`) %>%
group_by(`Nome`,`Grupo Problema`) %>%
summarize(n = length(`Grupo Problema`)) %>%
mutate(relFreq = n/sum(n), pos = sum(n) - cumsum(n) + 0.5*n) %>%
arrange(-n)
ggplot(var, aes(x=reorder(Nome, -n), y=n, fill=`Grupo Problema`)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c("lightblue", "steelblue2", "dodgerblue", "grey50", "mediumpurple", "pink", "dodgerblue4")) +
geom_text(aes(label=ifelse(relFreq >= 0.07, paste0(sprintf("%.0f", relFreq*100),"%"),""),
y=pos), colour="white") +
labs(title = "Número de Reclamações por Empresa segmentada por Grupo de Problema") +
theme(title=element_text(size = rel(0.8)),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
plot.title = element_text(hjust = 0.5))
#Importação das bibliotecas a serem usadas
library(data.table)
library(dplyr)
library(ggplot2)
library(rgeos)
library(sp)
library(maptools)
library(ggpubr)
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
var <- rec %>%
select(`Segmento de Mercado`) %>%
group_by(`Segmento de Mercado`) %>%
summarize(n = length(`Segmento de Mercado`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n) %>%
slice(1:5)
ggplot(var, aes(x=reorder(`Segmento de Mercado`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
scale_x_discrete(labels = c("Telecom","E-Comm","Bancos","Fabricantes","Varejo")) +
theme(axis.title.x=element_blank())
#Importação das bibliotecas a serem usadas
library(data.table)
library(dplyr)
library(ggplot2)
library(rgeos)
library(sp)
library(maptools)
library(ggpubr)
knitr::opts_chunk$set(fig.align="center")
var <- rec %>%
select(`Sexo`) %>%
group_by(`Sexo`) %>%
summarize(n = length(`Sexo`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Sexo`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Faixa Etária`) %>%
group_by(`Faixa Etária`) %>%
summarize(n = length(`Faixa Etária`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Faixa Etária`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
rec$`Faixa Etária`[rec$`Faixa Etária`="até 20 anos"] <- "até 20"
rec$`Faixa Etária`[rec$`Faixa Etária` == "até 20 anos"] <- "até 20"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 21 e 30 anos"] <- "21 a 30"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 31 e 40 anos"] <- "31 a 40"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 41 e 50 anos"] <- "41 a 50"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 51 e 60 anos"] <- "51 a 60"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 31 e 40 anos"] <- "61 a 70"
rec$`Faixa Etária`[rec$`Faixa Etária` == "mais de 70 anos"] <- "mais de 70"
var <- rec %>%
select(`Faixa Etária`) %>%
group_by(`Faixa Etária`) %>%
summarize(n = length(`Faixa Etária`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Faixa Etária`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
rec$`Faixa Etária`[rec$`Faixa Etária` == "até 20 anos"] <- "até 20"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 21 a 30 anos"] <- "21 a 30"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 31 a 40 anos"] <- "31 a 40"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 41 a 50 anos"] <- "41 a 50"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 51 a 60 anos"] <- "51 a 60"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 31 a 40 anos"] <- "61 a 70"
rec$`Faixa Etária`[rec$`Faixa Etária` == "mais de 70 anos"] <- "mais de 70"
var <- rec %>%
select(`Faixa Etária`) %>%
group_by(`Faixa Etária`) %>%
summarize(n = length(`Faixa Etária`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Faixa Etária`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
rec$`Faixa Etária`[rec$`Faixa Etária` == "até 20 anos"] <- "até 20"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 21 a 30 anos"] <- "21 a 30"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 31 a 40 anos"] <- "31 a 40"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 41 a 50 anos"] <- "41 a 50"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 51 a 60 anos"] <- "51 a 60"
rec$`Faixa Etária`[rec$`Faixa Etária` == "entre 61 a 70 anos"] <- "61 a 70"
rec$`Faixa Etária`[rec$`Faixa Etária` == "mais de 70 anos"] <- "mais de 70"
var <- rec %>%
select(`Faixa Etária`) %>%
group_by(`Faixa Etária`) %>%
summarize(n = length(`Faixa Etária`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Faixa Etária`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(Sexo, `Faixa Etária`, `Nota do Consumidor`, `Segmento de Mercado`) %>%
filter(complete.cases(`Nota do Consumidor`), `Segmento de Mercado`=='Operadoras de Telecomunicações (Telefonia, Internet, TV por assinatura)' | `Segmento de Mercado`=='Comércio Eletrônico' | `Segmento de Mercado`== 'Bancos, Financeiras e Administradoras de Cartão' | `Segmento de Mercado`== 'Fabricantes - Eletroeletrônicos, Produtos de Telefonia e Informática' | `Segmento de Mercado`== 'Varejo' ) %>%
group_by(Sexo, `Faixa Etária`, `Nota do Consumidor`) %>%
summarize(n = length(`Nota do Consumidor`)) %>%
mutate(relFreq = n/sum(n), pos = sum(n) - cumsum(n) + 0.5*n) %>%
arrange(-n)
ggplot(var, aes(x=`Faixa Etária`, y=n, fill=as.factor(`Nota do Consumidor`))) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=ifelse(n >= 0.15, paste0(sprintf("%.0f", relFreq*100),"%"),""),
y=pos), colour="white") +
facet_wrap(~Sexo) +
theme(axis.title.x=element_blank())
var <- telecom %>%
select(`newUF`, `Segmento de Mercado`,`Nome`, `Nota do Consumidor`) %>%
filter(complete.cases(telecom)) %>%
group_by(`newUF`, `Nome`) %>%
summarize(media = mean(`Nota do Consumidor`)) %>%
arrange(-media)
ggplot() + geom_map(data = var, aes(map_id = newUF, fill = media), map = brasil) +
geom_polygon(data = brasil, aes(x = long, y = lat, group = group), color = "gray75", fill = NA) +
expand_limits(x = brasil$long, y = brasil$lat) +
facet_wrap(~`Nome`, ncol=3) +
labs(title = "Média de Nota do Consumidor por Empresa e por Estado", fill="Nota \nMédia") +
theme(title=element_text(size = rel(0.8)),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
axis.text.x =element_blank(),
axis.text.y=element_blank(),
axis.ticks.x =element_blank(),
axis.ticks.y=element_blank(),
plot.title = element_text(hjust = 0.5))
var <- rec %>%
select(Sexo, `Faixa Etária`, `Nota do Consumidor`, `Segmento de Mercado`) %>%
filter(complete.cases(`Nota do Consumidor`), `Segmento de Mercado`=='Operadoras de Telecomunicações (Telefonia, Internet, TV por assinatura)' | `Segmento de Mercado`=='Comércio Eletrônico' | `Segmento de Mercado`== 'Bancos, Financeiras e Administradoras de Cartão' | `Segmento de Mercado`== 'Fabricantes - Eletroeletrônicos, Produtos de Telefonia e Informática' | `Segmento de Mercado`== 'Varejo' ) %>%
group_by(Sexo, `Faixa Etária`, `Nota do Consumidor`) %>%
summarize(n = length(`Nota do Consumidor`)) %>%
mutate(relFreq = n/sum(n), pos = sum(n) - cumsum(n) + 0.5*n) %>%
arrange(-n)
ggplot(var, aes(x=`Faixa Etária`, y=n, fill=as.factor(`Nota do Consumidor`))) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=ifelse(n >= 0.15, paste0(sprintf("%.0f", relFreq*100),"%"),""),
y=pos), colour="white") +
facet_wrap(~Sexo) +
labs(fill="Nota") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Tempo de Resposta`) %>%
group_by(`Tempo de Resposta`) %>%
summarize(n = length(`Tempo de Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
var <- rec %>%
select(`Tempo de Resposta`) %>%
group_by(`Tempo de Resposta`) %>%
summarize(n = length(`Tempo de Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
View(rec)
View(rec)
var <- rec %>%
select(`Tempo Resposta`) %>%
group_by(`Tempo Resposta`) %>%
summarize(n = length(`Tempo Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Tempo Resposta`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Tempo Resposta`) %>%
group_by(`Tempo Resposta`) %>%
summarize(n = length(`Tempo Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Tempo Resposta`), y=n)) +
var <- rec %>%
select(`Tempo Resposta`) %>%
group_by(`Tempo Resposta`) %>%
summarize(n = length(`Tempo Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Tempo Resposta`), y=n) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Tempo Resposta`) %>%
group_by(`Tempo Resposta`) %>%
summarize(n = length(`Tempo Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Tempo Resposta`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Grupo Problema`) %>%
group_by(`Grupo Problema`) %>%
summarize(n = length(`Grupo Problema`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Grupo Problema`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Grupo Problema`) %>%
group_by(`Grupo Problema`) %>%
summarize(n = length(`Grupo Problema`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Grupo Problema`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Resolvida`) %>%
group_by(`Resolvida`) %>%
summarize(n = length(`Resolvida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Resolvida`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Resolvida`) %>%
group_by(`Resolvida`) %>%
summarize(n = length(`Resolvida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Resolvida`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Resolvida`) %>%
group_by(`Resolvida`) %>%
summarize(n = length(`Resolvida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=as.factor(`Resolvida`), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Respondida`) %>%
group_by(`Respondida`) %>%
summarize(n = length(`Respondida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=as.factor(`Respondida`), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
rec$Resolvida[rec$`Avaliação Reclamação`=="Não Resolvida"] <- 0
rec$Resolvida[rec$`Avaliação Reclamação`=="Resolvida"] <- 1
rec$Resolvida[rec$`Avaliação Reclamação`=="Não Avaliada"] <- 1
cor(complete.cases(rec$`Nota do Consumidor`), complete.cases(rec$Resolvida))
ggplot(rec, aes(x=Resolvida, y=`Nota do Consumidor`)) +
geom_jitter(stat="identity", alpha=0.5)
var <- rec %>%
select(`Resolvida`) %>%
group_by(`Resolvida`) %>%
summarize(n = length(`Resolvida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=as.factor(`Resolvida`), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Avaliação Reclamação`) %>%
group_by(`Avaliação Reclamação`) %>%
summarize(n = length(`Avaliação Reclamação`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Avaliação Reclamação`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Avaliação Reclamação`) %>%
group_by(`Avaliação Reclamação`) %>%
summarize(n = length(`Avaliação Reclamação`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Avaliação Reclamação`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Tempo Resposta`) %>%
group_by(`Tempo Resposta`) %>%
summarize(n = length(`Tempo Resposta`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Tempo Resposta`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Nota do Consumidor`) %>%
group_by(`Nota do Consumidor`) %>%
summarize(n = length(`Nota do Consumidor`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`Nota do Consumidor`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Respondida`) %>%
group_by(`Respondida`) %>%
summarize(n = length(`Respondida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n) %>%
print
#ggplot(var, aes(x=as.factor(`Respondida`), y=n)) +
#  geom_histogram(stat = 'identity') +
#  geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
#  theme(axis.title.x=element_blank())
var <- rec %>%
select(`Respondida`) %>%
group_by(`Respondida`) %>%
summarize(n = length(`Respondida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=as.factor(`Respondida`), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.00f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Respondida`) %>%
group_by(`Respondida`) %>%
summarize(n = length(`Respondida`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=as.factor(`Respondida`), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.1f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Segmento de Mercado`) %>%
group_by(`Segmento de Mercado`) %>%
summarize(n = length(`Segmento de Mercado`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n) %>%
slice(1:5)
ggplot(var, aes(x=reorder(`Segmento de Mercado`,-n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
scale_x_discrete(labels = c("Telecom","E-Comm","Bancos","Fabricantes","Varejo")) +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Segmento de Mercado`, Sexo, `Faixa Etária`) %>%
filter(`Segmento de Mercado`=='Operadoras de Telecomunicações (Telefonia, Internet, TV por assinatura)' | `Segmento de Mercado`=='Comércio Eletrônico' | `Segmento de Mercado`== 'Bancos, Financeiras e Administradoras de Cartão' | `Segmento de Mercado`== 'Fabricantes - Eletroeletrônicos, Produtos de Telefonia e Informática' | `Segmento de Mercado`== 'Varejo') %>%
group_by(`Segmento de Mercado`, Sexo, `Faixa Etária`) %>%
summarize(n = length(`Segmento de Mercado`)) %>%
mutate(relFreq = n/sum(n), pos = sum(n) - cumsum(n) + 0.5*n) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Segmento de Mercado`,-n), y=n, fill=`Faixa Etária`)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=ifelse(relFreq >= 0.07, paste0(sprintf("%.0f", relFreq*100),"%"),""),
y=pos), colour="white") +
facet_wrap(~Sexo) +
scale_x_discrete(labels = c("Telecom","E-Comm","Bancos","Fabricantes","Varejo")) +
theme(axis.title.x=element_blank())
cor(complete.cases(rec$`Nota do Consumidor`), complete.cases(rec$`Tempo Resposta`))
ggplot(rec, aes(x=`Tempo Resposta`, y=`Nota do Consumidor`)) +
geom_jitter(stat="identity", alpha=0.5)
segsub <- subset(rec, `Segmento de Mercado`=='Bancos, Financeiras e Administradoras de Cartão' | `Segmento de Mercado`=='Comércio Eletrônico' | `Segmento de Mercado`=='Operadoras de Telecomunicações (Telefonia, Internet, TV por assinatura)')
var <- segsub %>%
select(`Segmento de Mercado`,`Grupo Problema`) %>%
group_by(`Segmento de Mercado`,`Grupo Problema`) %>%
summarize(n = length(`Grupo Problema`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`Grupo Problema`,-n), y=n)) +
geom_bar(stat="identity") +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100),"%") ,vjust=-0.5), color="Black") +
facet_wrap(~`Segmento de Mercado`, ncol=1) +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`UF`) %>%
group_by(`UF`) %>%
summarize(n = length(`UF`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`UF`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=paste0(sprintf("%.0f", relFreq*100), "%"), vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`UF`) %>%
group_by(`UF`) %>%
summarize(n = length(`UF`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=`UF`, y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=n, vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`UF`) %>%
group_by(`UF`) %>%
summarize(n = length(`UF`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n)
ggplot(var, aes(x=reorder(`UF`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=n, vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Nome`) %>%
group_by(`Nome`) %>%
summarize(n = length(`Nome`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n) %>%
slice(1:10)
ggplot(var, aes(x=reorder(`Nome`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=n, vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Nome`) %>%
group_by(`Nome`) %>%
summarize(n = length(`Nome`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n) %>%
slice(1:14)
ggplot(var, aes(x=reorder(`Nome`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=n, vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
var <- rec %>%
select(`Nome`) %>%
group_by(`Nome`) %>%
summarize(n = length(`Nome`)) %>%
mutate(relFreq = n/sum(n)) %>%
arrange(-n) %>%
slice(1:13)
ggplot(var, aes(x=reorder(`Nome`, -n), y=n)) +
geom_histogram(stat = 'identity') +
geom_text(aes(label=n, vjust=-0.5), color="Black") +
theme(axis.title.x=element_blank())
